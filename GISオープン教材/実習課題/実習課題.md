#実習課題について

**Menu**
--------
* [第一回課題（20160929）](#第一回課題（20160929）)
* [第二回課題（20161006）](#第二回課題（20161006）)
* [第三回課題（20161006）](#第三回課題（20161013）)
* [第四回課題（20161020）](#第四回課題（20161020）)


>実習時の注意点やメモを[作業メモ]をご参照ください。

## <a name = "第一回課題（20160929）"></a>第一回課題（20160929）

### 本日の課題
無償で利用出来るデータを活用し、以下の課題1と2に該当する地図を作成しなさい。
提出する地図は、凡例、方位、縮尺バー、タイトル（学籍番号、氏名、地図名）をレイアウトしたものとします。本課題と対応する教材は、[QGISビギナーズマニュアル]および[GRASSビギナーズマニュアル]の教材となります。

**課題１**  
QGISとプラグインを用いて、任意の地域の地図を作成しなさい。なお、使用するタイル（背景地図）は基本測量成果に該当しないものとする。
（必要な場合は、サンプルデータ[fkuchiyama_sample.zip](https://github.com/yamauchi-inochu/demo/blob/master/GISオープン教材/実習課題/sample/fkuchiyama_sample.zip?raw=true)を使用すること）

**完成例**  

![完成例](pic/Q1.png)

**手順**  

① サンプルデータを読み込む  
② タイルレイヤープラグインかOpenLayersPluginを用いて背景地図を読み込む  
③ 地図をレイアウトする   

#### 学習ポイント：空間データの特徴とGISソフトウェアの活用

* ベクトルデータとラスターデータの違い
* QGISとプラグインについての理解
* 属性テーブルとプロパティについての理解
* 地図のレイアウト

※　提出時に図のタイトル、名前、学籍番号を記載すること（方法：プリントコンポーザーから、新規ラベルの追加 > アイテムプロパティ > メインプロパティ（タイトル等の入力） > 外観,フォント（文字のサイズ調整））

------

**課題2**  
GRASS GISを用いて、高松市の地形(標高)概観図を作成しなさい。  
※20160929の実習では、課題2は提出しなくてよい

**手順**  

① QGISを用いてマップセットを作成する  
② GRASS GISでマップセットを読み込む  
③ カラーを調整し、地図をレイアウトする  

![完成例](pic/G1.png)

#### 学習ポイント：GRASS GISの操作

* マップセットが作成できたか

[△メニューへもどる]
-------------
## <a name = "第二回課題（20161006）"></a>第二回課題（20161006）

### 本日の課題
無償で利用出来るデータを活用し、以下の1〜3に該当する地図を作成しなさい。
提出する地図は、凡例、方位、縮尺バー、タイトル（学籍番号、氏名、地図名）をレイアウトしたものとします。
課題提出は、課題フォームより行うこととする。本課題と対応する教材は、[既存データの地図データと属性データ]および[空間データ]の教材となります。


**課題１:旧測地系と新測地系**  
[政府統計局e-stat]（平成２２年国勢調査（小地域））を利用し、日本測地系平面直角座標系・Shape形式と世界測地系平面直角座標系・Shape形式のデータを用いて、両データが重なり合わない地図を作成しなさい。
※　最新の測地系はJGD2011であるが、QGIS2.8.4ではJGD2011の変換ができないため、本実習ではJGD2000を新測地系としている（2.14は、JGD2011に対応）。

**完成例**  
![完成例](pic/8-1.png)

**手順**  
①　e-statから任意の地域の異なるshapeファイル（投影座標系のもの）をダウンロードする  
②　QGISでデータを表示する（デフォルトではずれて表示されないため、右下のボタンから、オンザフライ投影のチェックをはずす）  
③　QGISビギナーズマニュアルを参考に、地図をレイアウトする  
④　レイアウト後に旧測地系データを新測地系に変換する（地図データが重なればOK）  
⑤　QGISの作業ファイル（.qgs）に任意の名前をつけ保存し、画面を閉じる

#### 学習ポイント：測地系
GISでは、データ分析をする前にデータの測地系を整える必要があります。この作業を行わないと位置のズレが生じ、データの処理が行えない場合があります。異なった測地系のデータを扱う場合は、以下の項目への理解が必要となります（わからない単語はインターネットで調べてください）。

* 地理座標系と投影座標系の違い
* 平面直角座標系第◯系の意味
* 旧測地系と新測地系の違い
* 座標系の変換手法

-------
**課題2：ジオリファレンス**  
鯖江市のオープンデータより古地図007と基盤地図情報2500基本項目鯖江市道路をダウンロードし、それをもとにGCPを取得し、画像の位置あわせを行った地図を作成しなさい（なお、基盤地図情報の取得変換ができない場合は、地理院タイル等を利用すること）。

**完成例**  
![完成例](pic/8-2.png)

**手順**  
① [鯖江市のオープンデータ](http://www.city.sabae.fukui.jp/pageview.html?id=12768)より古地図007をダウンロードする。  
② [sabae_sample](https://github.com/yamauchi-inochu/demo/blob/master/GISオープン教材/実習課題/sample/sabae_sample.zip?raw=true)とタイルレイヤプラグインを用いて地理院タイル（標準地図など）を読み込んでおく（高い位置精度を求める場合は、基盤地図情報の道路縁等を用いることが望ましい。）  
④ 古地図を読み込みQGISのジオリファレンサーを起動する  
⑤ ジオリファレンサーの利用法を参考に、古地図007にGCP(Ground Control Point)を付加する(完全には一致しないため、おおまかでよい)  
⑥ QGISビギナーズマニュアルを参考に、地図をレイアウトする(古地図のプロパティを開き、画像を透過すると良い)  
⑦ QGISの作業ファイル（.qgs）に任意の名前をつけ保存し、画面を閉じる  

※本来は精度を求めるため、ベクトルデータを用いてジオリファレンスをすることが多い。しかし、本実習ではQGIS2.8がJGD2011に対応していないことから、基盤地図情報（道路縁など）のような高精度ベクトルデータを用いていない。

#### 学習ポイント：ジオリファレンス
* ジオリファレンスとは（どのようなときに必要な処理か？）

-------

**課題3：ジオコーディング**  
サンプルデータ[susono_emergency_shelter.csv](https://github.com/yamauchi-inochu/demo/blob/master/GISオープン教材/実習課題/sample/susono_sample.zip?raw=true)の住所を用いて、ジオコーディング（アドレスマッチング)を行い地図を作成しなさい。

**完成例**  
![完成例](pic/8-3.png)

**手順**  
① CSVアドレスマッチングサービスを用いて、サンプルデータに位置情報（X、Y）を付加する。  
② CSVデータを読み込みshapeファイルに変換する。  
③ 変換したShapeファイルの座標系を平面直角座標第８系に変換する  
④ QGISビギナーズマニュアルを参考に、地図をレイアウトする(古地図のプロパティを開き、画像を透過すると良い)  
⑤ QGISの作業ファイル（.qgs）に任意の名前をつけ保存し、画面を閉じる


#### 学習ポイント：ジオコーディング
* ジオコーディングとは（どのような時に必要な処理か？）

[△メニューへもどる]

-------

## <a name="第三回課題（20161013）"></a>第三回課題（20161013）

### 本日の課題:新規ラスタデータとベクトルデータの作成練習
ベクトルデータとラスターデータ（課題データ）を用いて、以下の課題1に該当する地図を作成してください。
提出する地図は、凡例、方位、縮尺バー、タイトル（学籍番号、氏名、地図名）をレイアウトしたものとします。
課題提出は、課題フォームを利用してください。本課題と対応する教材は、[視覚的伝達]および[空間データの結合・修正]の教材となります。

**課題１:ベクトルデータの加工と地図作成**  
課題データと地理院タイル（東日本大震災被災地震災後オルソ画像（2012年10月～2013））を用いて完成例のような画像を作成し、課題フォームより提出してください。課題の作成には、下記の手順と[空間データの結合・修正]の教材を参考にしてください。タイルレイヤプラグインで用いるTSVファイルは、第1回の課題データに含まれています
(使い方は[作業メモ]を参照)。  

>課題データは、基盤地図情報数値標高モデル（5ｍDEM）を変換し、複数のラスタを結合した後に、平面直角座標系へ座標変換を行ったものである。


**完成例**  
![kadai](pic/10-1.png)

**手順**  

① 課題データをQGISで読みこむ。  
② 旧北上川右岸の日和山を中心とし、ラスタデータを任意の範囲で切り抜き、新規ラスタの配色をプロパティから調整する（任意の値で設定）。  
③ 10m間隔の等高線を抽出する。  
④ ポイントの作成：地理院タイル（標準地図等）や課題データを利用し、任意の5地点の標高を調べポイントを作成する。属性は、id(Integer,幅2)、地名(String,幅20)、標高(Real,幅５〜６,精度2~3)とし、属性テーブルは、Id(通し番号)、付近の地名（もしくは建物名）、標高値を記入する。標準地図から標高値を求める場合は、地図から標高点を探す。ラスタから標高値を求める場合は、レイヤウィンドウでレイヤを選択した状態で、地物情報表示ツールをオンにする（アイコンをクリックする）。調べたい地点をクリックすると情報が表示される。  
⑤ ラインの作成：タイルレイヤプラグインを用いて背景地図（東日本大震災被災地震災後オルソ画像（2012年10月～2013））を表示し、旧北上川の橋をトレースする（なぞる）。※ラインの新規作成は、作成後右クリックで新規レイヤとして反映される。  
⑥ ポリゴンの作成：ライン作成時に利用した空中写真を用いて、日和山の植生が多くみられる部分のポリゴンを作成する（おおまかでよい）。※ポリゴンの新規作成は、作成後右クリックで新規レイヤとして反映される。  
⑦ 各レイヤごとに色分けやラベル表示を行う。  
⑧ 地図をレイアウトし、提出する。  

#### 学習ポイント
* ラスタデータの結合・切り抜き
* 新規ベクトルレイヤの作成手法
* ベクトルデータの特徴
* 各レイヤのスタイル調整

-----------

**任意課題（余裕があれば）:カルトグラムの作成**  
[政府統計局e-stat]から国勢調査（小地域）のデータ（市区町村の町丁目人口）を用いてカルトグラム(統計データに基づいて面積や距離を変形させた地図)を作成してください。

> 東北大学 空間計画科学研究室 [カルトグラムとは?](http://www.plan.civil.tohoku.ac.jp/inoue/research/cartogram/)

**完成例**  
![kadai](pic/21-1.png)

**手順**  
①[政府統計局e-stat]のページから、「平成22年国勢調査（小地域）」を選択し（統計表は任意で指定する）、市区町村の境界データ（世界測地系平面直角座標系・Shape形式）をダウンロードする。  
②QGISでレイヤをデータを読み込み、画面左側に表示されるレイヤの一覧から対象のデータの上で右クリックし属性テーブルを開く。属性テーブルにJINKOの項目があるかを確認する。JINKOの値に0があると計算できないため、対象のテーブルを削除するか、値を1とする。  
③QGISの「プラグインの管理とインストール」から「Cartogram」プラグインをインストールする。  
④Cartogramプラグインを起動し、JINKOの値を用いてカルトグラムを作成する。  
⑤レイヤのプロパティを開き値を色分けする（人口ごとに色分けする/正確に分類する場合は、分類数の設定にはスタージェスの公式等を用いると良い）。  
⑥地図をレイアウトする。  

-------------

## <a name = "第四回課題（20161020）"></a>第四回課題（20161020）

### 本日の実習と課題：基本的な空間解析とネットワーク分析
　前回までの実習で、QGISを用いたGISソフトウェアの基本操作と空間データ（ラスターデータやベクトルデータ）の作成、改変、座標変換等について学習しました。本実習では、空間データから新たなデータを計測する手法および複数の空間データの位置関係から新規データの作成や距離の計測を行います。  
　課題1としてGISソフトウェア上で地物の大きさを計測する手法を学びます。課題2では、ベクトルデータの形状を用いて新規のデータを作成する手法を学びます。課題3では、道路データを用いて任意の地点間の最短経路検索を行うものです。無償で利用出来るデータを活用し、以下の1～3に該当する課題を行い、課題フォームより提出または回答してください。  
　提出する地図は、凡例、方位、縮尺バー、タイトル（学籍番号、氏名、地図名）をレイアウトしたものとします。本課題と対応する教材は、[基本的な空間解析]および[ネットワーク分析]の教材となります。  
　実習をはじめる前に、以下のデータをダウンロードしてください。なお、e-satのデータは、世界測地系、JGD2000の平面直角座標系第Ⅵ系でダウンロードすること。国土数値情報のデータはダウンロード後に「JGD2000の平面直角座標系第Ⅵ系」へ座標変換すること。(すべてのレイヤをJGD2000の平面直角座標系第Ⅵ系で統一しないと、解析の際にエラーが発生する)。国土数値情報データの読み込み時に空間参照設定のウィンドウが表示されたら、JGD2000を選択する（今回の場合）。  


**実習用データ**  

* [国土数値情報] 奈良県の行政区域、学校、河川、道路データ
　※道路データは、旧 統一フォーマット形式GML(JPGIS2.1)からダウンロードする。
* [政府統計局e-Stat] 奈良市、大和郡山市の境界データ

  >ダウンロード手法は、[既存データの地図データと属性データ]を参考とする。座標系の変換手法は[空間データの教材](https://github.com/yamauchi-inochu/demo/blob/master/GISオープン教材/08_空間データ/空間データ.md#投影変換地理座標系から投影座標系)を参考とする。

※ 実習の最初に、各教材の上段にリンクされている講義用教材をダウンロードし、本実習と関係するGIS理論や概念など内容を一読しておくことを推奨します。
-----------------

**課題１:GISを用いた周長と面積の自動計測**  
　GISで示される地物は、位置や形状が座標で管理されています。そのためGIS上で、周長や面積計算を行うことができます。課題1は、属性テーブルから自動で面積と周長を計算する手法を学ぶものです。奈良県のデータを[国土数値情報]からダウンロードし、以下の手順と[基本的な空間解析]の教材を参考に、処理を行い課題フォームの質問（課題1）に回答してください。

**手順**  
1. QGISで、[国土数値情報]からダウンロードした奈良県の行政区域を読み込む。  
2. 編集モード切替ボタンをクリックし、属性テーブルを開く。  
3. 新規属性テーブルを作成し、各市町村ポリゴンごとに周長を計測する。  
4. 同じように新規属性テーブルを作成し、各市町村ポリゴンごとに面積を計測する。  
5. 属性テーブルから山添村を探し、周長と面積確認し、課題フォームの質問に回答する。  
6. 編集モード切替ボタンを再度クリックし、編集を完了させる。  
※ 編集を完了（保存）しないとデータは更新されない。  

-----------------

**課題2:ベクトルデータの形状を用いた新規レイヤの作成**  
　ベクトルデータには、形状、位置、属性等が含まれています。lこの課題では、それらの情報を解析し新規レイヤを取得する手法を学びます。GISで解析をする場合、空間データの範囲が適切であるかということが重要になります。例えば東京都の駅数を計算する場合には、東京都の範囲のみのデータで十分ですが、国土数値情報でダウンロードできるデータは全国分のものになります。この場合、分析に必要のない範囲のデータを含んでいるため、分析用に東京都の範囲のデータを抽出する必要があります。課題2では、必要な範囲を求め、レイヤとして作成する手法を学ぶものです。以下の手順と[基本的な空間解析]の教材を参考に、奈良県内の学校のうち、奈良市と大和郡山市に位置するものを抽出し、課題フォームの質問（課題2）より地図をアップロードしてください。なお、提出する地図は、位置関係が分かるように範囲内の河川（または道路:課題3との関係上道路データの方が望ましい）が抽出されたものとします。

**完成例**  
![kadai](pic/11-1.png)

**手順**  
1. [政府統計局e-stat]からダウンロードしたデータと課題1で使用したデータを読み込む。  
2. 奈良市と大和郡山市のポリゴンを一つに、[マージ](http://www.pasco.co.jp/recommend/word/word092/)する。  
3. マージしたポリゴンを行政界のないポリゴン（奈良市と大和郡山市が一つになっている）にするため、[デイゾルブ](http://www.pasco.co.jp/recommend/word/word091/)する。  
4. 河川レイヤ（または、道路）を読み込み、対象範囲を用いて[インターセクト](http://www.pasco.co.jp/recommend/word/word094/)する。  
5. 奈良市と大和郡山市の学校、行政区ポリゴン、河川などのレイヤをレイアウトし、地図を作成する（完成例を参照）
    >用語のリンク先に、[PSCO用語集](http://www.pasco.co.jp/recommend/word/word092/)を利用  
---------

**課題3:QGISで最短経路検索**  
　課題3は、ネットワーク分析を行うものです。ネットワーク分析とはネットワークデータ（ライン等）を用いて、経路検索や到達圏分析などを行うものです。詳しくは、[ネットワーク分析]の教材を参照してください。課題3は、QGISで簡単にできるネットワーク分析の手法として最短経路検索の手法を学ぶものです。以下の手順と[ネットワーク分析]を参考に、任意の2点間の最短経路（標高などのコストを含まない）を求め、課題フォームの質問（課題3）に回答してください。なお、分析用のデータは、課題2で学んだ手法を用いて作成してください。

**完成例**  
![kadai](pic/12-1.png)

**手順**  
1. 課題2で作成した奈良市と大和郡山市がマージされたポリゴンをもちいて道路を抽出する。  
2. レイヤウィンドウのポイントデータの上で右クリックし、プロパティからラベルを表示する。  
3. 上段ウィンドウのアイコンのないグレーの個所で右クリックし、最短経路にチェックをいれ、道路グラフプラグインを起動する。    
※表示されない場合は、プラグインの管理とインストールでチェックが有効になっているか確認する。  
4. ベクタ＞道路グラフをクリックし、使用するラインレイヤを設定し、「OK」をクリックする。  
※ネットワーク分析では、分析用にポイントと接合したグラフ（ライン）を作成する(今回の課題では、プラグインを使ってその処理を省略しているが、GRASS GISのネットワーク分析ではグラフの作成手法を解説している)。  
5. レイヤウィンドウで道路を選択した状態で、分析したい開始点と終了点の右横アイコンをクリックし、地図上で任意の2地点（学校のポイント付近）地点をクリックする（座標を設定する）。その後、計算をクリックすると長さと時間が算出される。  
6. 最短経路ウィンドウから長さと時間を確認し、課題フォームの質問に回答する（記入欄に「○○学校と○○学校との最短距離は○○.○○kmでした」の○○の語句を埋めて回答してください）。  

--------
#### 完成例で使用したデータ
本ページで使用しているデータの出典については、該当する教材よりご確認ください。

[△メニューへもどる]:実習課題.md#menu
[作業メモ]:https://github.com/yamauchi-inochu/demo/blob/master/GISオープン教材/実習課題/作業メモ.md
[QGISビギナーズマニュアル]:../QGISビギナーズマニュアル/QGISビギナーズマニュアル.md
[GRASSビギナーズマニュアル]:../GRASSビギナーズマニュアル/GRASSビギナーズマニュアル.md
[既存データの地図データと属性データ]:../07_既存データの地図データと属性データ/既存データの地図データと属性データ.md
[空間データ]:../08_空間データ/空間データ.md
[空間データの結合・修正]:../10_空間データの統合・修正/空間データの統合・修正.md
[視覚的伝達]:../21_視覚的伝達/視覚的伝達.md
[政府統計局e-stat]:https://www.e-stat.go.jp/SG1/estat/eStatTopPortal.do
[国土数値情報]:http://nlftp.mlit.go.jp/ksj/
[基本的な空間解析]:../11_基本的な空間解析/基本的な空間解析.md
[ネットワーク分析]:../12_ネットワーク分析/ネットワーク分析.md
